<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SpiderKong Panel</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

  <link rel="stylesheet" href="./dock.css" />
</head>

<body>
  <div class="appShell">
    <!-- ========== HEADER ========== -->
    <header class="headerRow">
      <div class="brand">
        <span class="logoType">SPIDERKONG</span>
      </div>

      <div class="headerControls">
        <div class="sceneSelectWrap">
          <select id="sceneSelect" aria-label="Cena atual" title="Mudar Cena">
            <option value="">Carregando...</option>
          </select>
        </div>

        <div class="skinSelectWrap">
          <select id="skinSelect" aria-label="Skin" title="Mudar Skin">
            <option value="">Carregando...</option>
          </select>
        </div>

        <div class="statusGroup">
          <span id="pillWs" class="pill pill--off" title="Status da Conexao">
            <span class="material-symbols-outlined">wifi_off</span>
            <span id="pillWsText">Desconectado</span>
          </span>
        </div>
      </div>
    </header>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="mainContent">
      <div id="mainPanelsWrap">

        <!-- ===== TIMES ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Times</div>
          </div>
          <div class="cardBody">
            <div class="teamsGrid">
              <!-- Time Casa -->
              <div class="teamBlock">
                <div class="teamLabel">Casa</div>
                <img id="homeLogoPreview" class="teamLogoPreview" src="" alt="Escudo Casa" />
                <select id="homeTeamSelect">
                  <option value="">Selecionar time...</option>
                </select>
                <input id="homeTeamName" type="text" placeholder="Nome do time" />
                <input id="homeTeamSigla" type="text" placeholder="Sigla" maxlength="4" />
                <input id="homeCoach" type="text" placeholder="Tecnico" />
                <button id="btnApplyHome" class="btn btn--primary full-width">Aplicar</button>
              </div>

              <!-- Time Visitante -->
              <div class="teamBlock away">
                <div class="teamLabel">Visitante</div>
                <img id="awayLogoPreview" class="teamLogoPreview" src="" alt="Escudo Visitante" />
                <select id="awayTeamSelect">
                  <option value="">Selecionar time...</option>
                </select>
                <input id="awayTeamName" type="text" placeholder="Nome do time" />
                <input id="awayTeamSigla" type="text" placeholder="Sigla" maxlength="4" />
                <input id="awayCoach" type="text" placeholder="Tecnico" />
                <button id="btnApplyAway" class="btn btn--primary full-width">Aplicar</button>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== PLACAR ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Placar</div>
            <div class="cardActions">
              <button id="btnScoreReset" class="btn btn--ghost" title="Zerar placar">
                <span class="material-symbols-outlined">refresh</span>
              </button>
            </div>
          </div>
          <div class="cardBody">
            <div class="scoreboardWrap">
              <div class="scoreGroup">
                <div class="scoreTeamInfo">
                  <div id="scoreSiglaHome" class="scoreTeamSigla">CAS</div>
                  <div id="scoreNameHome" class="scoreTeamName">Casa</div>
                </div>
                <button id="btnScoreHomeMinus" class="btn btn--round">-</button>
                <span id="scoreHome" class="scoreDisplay">0</span>
                <button id="btnScoreHomePlus" class="btn btn--round">+</button>
              </div>

              <span class="vsIcon">X</span>

              <div class="scoreGroup">
                <button id="btnScoreAwayMinus" class="btn btn--round">-</button>
                <span id="scoreAway" class="scoreDisplay">0</span>
                <button id="btnScoreAwayPlus" class="btn btn--round">+</button>
                <div class="scoreTeamInfo">
                  <div id="scoreSiglaAway" class="scoreTeamSigla">VIS</div>
                  <div id="scoreNameAway" class="scoreTeamName">Visitante</div>
                </div>
              </div>
            </div>

            <!-- Agregado -->
            <div class="aggWrap">
              <button id="btnToggleAgg" class="btn btn--toggle aggToggle">
                <span class="material-symbols-outlined">calculate</span>
                Agregado: OFF
              </button>
              <div id="aggControls" class="aggControls isHidden">
                <div class="aggSide">
                  <button id="btnAggHomeMinus" class="btn btn--round-sm">-</button>
                  <div class="aggDisplay">
                    <div class="aggLabel">Ida</div>
                    <div id="aggHome" class="aggValue">0</div>
                  </div>
                  <button id="btnAggHomePlus" class="btn btn--round-sm">+</button>
                </div>

                <div class="aggTotal">
                  <div class="aggTotalLabel">Total</div>
                  <div id="aggTotalDisplay" class="aggTotalValue">(0) - (0)</div>
                </div>

                <div class="aggSide">
                  <button id="btnAggAwayMinus" class="btn btn--round-sm">-</button>
                  <div class="aggDisplay">
                    <div class="aggLabel">Ida</div>
                    <div id="aggAway" class="aggValue">0</div>
                  </div>
                  <button id="btnAggAwayPlus" class="btn btn--round-sm">+</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== CRONOMETRO ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Cronometro</div>
          </div>
          <div class="cardBody">
            <div class="timerWrap">
              <div class="timerDisplayBox">
                <span id="timerDisplay" class="timerDisplay">00:00</span>
              </div>
              <div class="timerSetBox">
                <input id="timerSetInput" type="text" placeholder="mm:ss" maxlength="5" />
                <button id="btnTimerSet" class="btn">SET</button>
              </div>
            </div>

            <div class="timerActions">
              <button id="btnTimerStart" class="btn btn--primary">
                <span class="material-symbols-outlined">play_arrow</span>
                Iniciar
              </button>
              <button id="btnTimerPause" class="btn">
                <span class="material-symbols-outlined">pause</span>
                Pausar
              </button>
              <button id="btnTimerReset" class="btn">
                <span class="material-symbols-outlined">refresh</span>
                Zerar
              </button>
            </div>

            <div class="periodBar">
              <button id="btnPeriod1T" class="btn btn--status active" data-period="1T">1T</button>
              <button id="btnPeriod2T" class="btn btn--status" data-period="2T">2T</button>
              <button id="btnPeriodInt" class="btn btn--status" data-period="INT">INT</button>
              <button id="btnPeriodPro" class="btn btn--status" data-period="PRO">PRO</button>
              <button id="btnPeriodPen" class="btn btn--status" data-period="PEN">PEN</button>
            </div>
          </div>
        </section>

        <!-- ===== PENALTIS ===== -->
        <section id="penaltiesCard" class="card penaltiesCard isHidden">
          <div class="cardHeader">
            <div class="cardTitle">Disputa de Penaltis</div>
            <div class="cardActions">
              <button id="btnPenaltyReset" class="btn btn--danger">
                <span class="material-symbols-outlined">refresh</span>
                Limpar
              </button>
            </div>
          </div>
          <div class="cardBody">
            <div class="penaltiesGrid">
              <div class="penaltiesTeam">
                <span id="penTagHome" class="penTag">CAS</span>
                <div id="penListHome" class="penShots"></div>
                <span id="penScoreHome" class="penTag">0</span>
              </div>
              <div class="penaltiesTeam">
                <span id="penTagAway" class="penTag">VIS</span>
                <div id="penListAway" class="penShots"></div>
                <span id="penScoreAway" class="penTag">0</span>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== ESCALACAO ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Escalacao</div>
            <div class="cardActions">
              <button id="btnClearRoster" class="btn btn--ghost" title="Limpar escalacao">
                <span class="material-symbols-outlined">delete</span>
              </button>
              <button id="btnToggleRoster" class="btn btn--icon" title="Expandir/Recolher">
                <span class="material-symbols-outlined">expand_more</span>
              </button>
            </div>
          </div>
          <div id="rosterBody" class="rosterBody isHidden">
            <div class="rosterGrid">
              <!-- Escalacao Casa -->
              <div class="rosterTeam">
                <div class="rosterLabel">Casa</div>
                <div class="rosterCoach">
                  <label>Tecnico:</label>
                  <input id="rosterCoachHome" type="text" placeholder="Nome do tecnico" />
                </div>
                <div id="rosterInputsHome" class="rosterList"></div>
              </div>

              <!-- Escalacao Visitante -->
              <div class="rosterTeam">
                <div class="rosterLabel">Visitante</div>
                <div class="rosterCoach">
                  <label>Tecnico:</label>
                  <input id="rosterCoachAway" type="text" placeholder="Nome do tecnico" />
                </div>
                <div id="rosterInputsAway" class="rosterList"></div>
              </div>
            </div>
            <button id="btnApplyRoster" class="btn btn--primary full-width mt-12">Salvar Escalacao</button>
          </div>
        </section>

        <!-- ===== JOGADORES EM CAMPO ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Jogadores em Campo</div>
            <div class="cardActions">
              <button id="btnTogglePlayers" class="btn btn--icon" title="Expandir/Recolher">
                <span class="material-symbols-outlined">expand_less</span>
              </button>
            </div>
          </div>
          <div id="playersBody" class="rosterBody">
            <div class="rosterGrid">
              <div class="rosterTeam">
                <div class="rosterLabel">Casa</div>
                <div id="playersListHome" class="rosterList"></div>
              </div>
              <div class="rosterTeam">
                <div class="rosterLabel">Visitante</div>
                <div id="playersListAway" class="rosterList"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== HISTORICO ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Historico</div>
            <div class="cardActions">
              <button id="btnClearHistory" class="btn btn--ghost" title="Limpar historico">
                <span class="material-symbols-outlined">delete</span>
              </button>
              <button id="btnToggleHistory" class="btn btn--icon" title="Expandir/Recolher">
                <span class="material-symbols-outlined">expand_more</span>
              </button>
            </div>
          </div>
          <div id="historyBody" class="cardBody isHidden">
            <div id="historyList" class="historyList">
              <div class="text-center text-muted text-sm">Nenhum evento registrado</div>
            </div>
          </div>
        </section>

        <!-- ===== ACOES ===== -->
        <section class="card">
          <div class="cardHeader">
            <div class="cardTitle">Acoes</div>
          </div>
          <div class="cardBody">
            <div class="actionsGrid">
              <button id="btnSyncObs" class="btn btn--primary">
                <span class="material-symbols-outlined">sync</span>
                Sync OBS
              </button>
              <button id="btnReconnect" class="btn">
                <span class="material-symbols-outlined">refresh</span>
                Reconectar
              </button>
              <button id="btnResetPartial" class="btn btn--secondary">
                <span class="material-symbols-outlined">restart_alt</span>
                Reset Parcial
              </button>
              <button id="btnResetTotal" class="btn btn--danger">
                <span class="material-symbols-outlined">delete_forever</span>
                Reset Total
              </button>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <!-- ========== MODAL: ACOES DO JOGADOR ========== -->
  <div id="playerModal" class="modalMask" aria-hidden="true">
    <div class="modal small-modal">
      <div class="modalHead">
        <div class="modalTitle">Acoes do Jogador</div>
        <button id="btnPlayerModalClose" class="btn btn--ghost">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="modalBody">
        <div id="playerModalInfo" class="playerModalInfo">
          <div id="playerModalNumber" class="playerModalNumber">00</div>
          <div id="playerModalName" class="playerModalName">Nome do Jogador</div>
          <div id="playerModalTeam" class="playerModalTeam">Time</div>
          <div id="playerModalStats" class="playerModalStats"></div>
        </div>
        <div class="playerModalActions">
          <button id="btnPlayerGoal" class="btn btn--goal">
            <span class="material-symbols-outlined">sports_soccer</span>
            Gol
          </button>
          <button id="btnPlayerYellow" class="btn btn--yellow">
            <span class="material-symbols-outlined">rectangle</span>
            Amarelo
          </button>
          <button id="btnPlayerRed" class="btn btn--red">
            <span class="material-symbols-outlined">rectangle</span>
            Vermelho
          </button>
          <button id="btnPlayerSub" class="btn btn--sub">
            <span class="material-symbols-outlined">swap_horiz</span>
            Substituir
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== MODAL: SUBSTITUICAO ========== -->
  <div id="subModal" class="modalMask" aria-hidden="true">
    <div class="modal small-modal">
      <div class="modalHead">
        <div class="modalTitle">Substituicao</div>
        <button id="btnSubModalClose" class="btn btn--ghost">
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
      <div class="modalBody">
        <div class="subModalOut">
          <div class="subModalOutLabel">Sai</div>
          <div id="subModalOutName" class="subModalOutName">-</div>
        </div>

        <div class="subModalIn">
          <div class="subModalInLabel">Entra</div>
          <div class="subModalInputs">
            <input id="subInNumber" type="text" class="numInput" placeholder="Num" maxlength="2" />
            <input id="subInName" type="text" class="nameInput" placeholder="Nome do jogador que entra" />
          </div>
        </div>

        <button id="btnSubConfirm" class="btn btn--primary full-width" disabled>
          <span class="material-symbols-outlined">check</span>
          Confirmar Substituicao
        </button>
      </div>
    </div>
  </div>

  <!-- ========== SCRIPTS ========== -->
  <script>
    (function () {
      function loadScript(src) {
        return new Promise((resolve, reject) => {
          const script = document.createElement("script");
          script.src = src;
          script.onload = resolve;
          script.onerror = () => reject(new Error(`Failed to load: ${src}`));
          document.head.appendChild(script);
        });
      }

      (async () => {
        try {
          const cacheBuster = Date.now();
          await loadScript(`./config.js?v=${cacheBuster}`);
          await loadScript(`./teams.data.js?v=${cacheBuster}`);
          await loadScript(`./roster.data.js?v=${cacheBuster}`);
          await loadScript(`./app.js?v=${cacheBuster}`);
        } catch (error) {
          document.body.innerHTML = `
            <div style="padding: 20px; background: #1a1a1a; color: #ff5252; font-family: monospace;">
              <h2>Erro ao carregar</h2>
              <pre>${error.message}</pre>
            </div>
          `;
        }
      })();
    })();
  </script>
</body>
</html>
